<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WG Access Comparator v3.0 | AQCM</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="app">
        
        <!-- Header -->
        <header id="main-header">
            <div class="header-content">
                <h1 class="app-title">
                    <span class="title-main">WG Access Comparator v3.0</span>
                    <span class="title-sub">Multi-System Access Validation Tool</span>
                </h1>
                
                <!-- Header Actions -->
                <div class="header-actions">
                    <button id="btn-log" class="btn-icon" title="View Activity Log">
                        <span>üìã</span> Log
                    </button>
                    <button id="btn-matrix" class="btn-icon" title="Role & Matrix Guide">
                        <span>üìä</span> Matrix
                    </button>
                    <button id="btn-options" class="btn-icon" title="Options">
                        <span>‚öôÔ∏è</span> Options
                    </button>
                    <button id="btn-guide" class="btn-icon" title="User Guide">
                        <span>üìñ</span> Guide
                    </button>
                </div>
            </div>
        </header>

        <!-- Control Toolbar -->
        <section id="toolbar" class="toolbar">
            <div class="toolbar-group">
                <!-- System Selection -->
                <div class="control-group">
                    <label for="system-select">System:</label>
                    <select id="system-select">
                        <option value="TOPS">TOPS</option>
                        <option value="Postedge">Postedge</option>
                        <option value="FeeAggregator">Fee Aggregator</option>
                        <option value="VPS">VPS (Global Framework)</option>
                    </select>
                </div>

                <!-- Mode Selection -->
                <div class="control-group">
                    <label for="mode-select">Mode:</label>
                    <select id="mode-select">
                        <option value="Add">Add (New User)</option>
                        <option value="Modify">Modify (Existing User)</option>
                        <option value="Monthly">Monthly Audit</option>
                    </select>
                </div>

                <!-- Role Selection -->
                <div class="control-group" id="role-group">
                    <label for="role-select">Role:</label>
                    <select id="role-select">
                        <option value="">-- Select Role --</option>
                        <option value="SA PROFILE">SA PROFILE</option>
                        <option value="SA WITH TRANSIT & SYND. PROFILE">SA WITH TRANSIT & SYND. PROFILE</option>
                        <option value="SA WITH SYNDICATE PROFILE">SA WITH SYNDICATE PROFILE</option>
                        <option value="IA PROFILE">IA PROFILE</option>
                        <option value="ASSOCIATE IA PROFILE">ASSOCIATE IA PROFILE</option>
                        <option value="Branch Assistant & Cage Profile">Branch Assistant & Cage Profile</option>
                        <option value="BA & CAGE INQUIRY">BA & CAGE INQUIRY</option>
                        <option value="BA/ABM/BM and Backup">BA/ABM/BM and Backup</option>
                        <option value="BA ABM BM AND BACKUP PROFILE">BA ABM BM AND BACKUP PROFILE</option>
                        <option value="BA/ABM/BM ACWS INQUIRY">BA/ABM/BM ACWS INQUIRY</option>
                        <option value="INQUIRY ONLY - BRANCH ASSISTANT AND CAGE PROFILE - Secondary Role">INQUIRY ONLY - Secondary Role</option>
                    </select>
                </div>
            </div>

            <div class="toolbar-group toolbar-actions">
                <button id="btn-compare" class="btn btn-primary">
                    <span>‚ñ∂ Compare</span>
                </button>
                <button id="btn-clear" class="btn btn-secondary">Clear All</button>
            </div>
        </section>

        <!-- Main Content -->
        <main id="main-content">
            
            <!-- Input Section -->
            <section id="input-section" class="input-panel">
                
                <!-- ADD MODE INPUTS -->
                <div id="add-inputs" class="mode-inputs">
                    <h2 id="add-mode-title">Add Mode - New User (TOPS)</h2>
                    
                    <div class="input-group">
                        <label for="add-servicenow">
                            ServiceNow Request (IA Codes Only)
                            <span class="help-text">Paste requested IA codes from ticket</span>
                        </label>
                        <textarea 
                            id="add-servicenow" 
                            rows="6" 
                            placeholder="DX2 DX7 DX5 RRU"></textarea>
                        <small class="token-count" id="add-servicenow-count">0 codes</small>
                    </div>

                    <div class="input-group">
                        <label for="add-reflection">
                            Reflection Added Access (All Codes)
                            <span class="help-text">Paste all codes added in Reflection</span>
                        </label>
                        <textarea 
                            id="add-reflection" 
                            rows="8" 
                            placeholder="DX2 DX7 DX5 REGA WGCOMMSTD *SAFUNC *SASCON"></textarea>
                        <small class="token-count" id="add-reflection-count">0 codes</small>
                    </div>
                </div>

                <!-- MODIFY MODE INPUTS -->
                <div id="modify-inputs" class="mode-inputs" style="display: none;">
                    <h2>Modify Mode - Existing User (TOPS Only)</h2>
                    
                    <div class="input-group">
                        <label for="modify-servicenow">
                            ServiceNow Request (IA Codes Only)
                            <span class="help-text">Paste requested changes from ticket</span>
                        </label>
                        <textarea 
                            id="modify-servicenow" 
                            rows="5" 
                            placeholder="DX2 DX7 DX5"></textarea>
                        <small class="token-count" id="modify-servicenow-count">0 codes</small>
                    </div>

                    <div class="input-group">
                        <label for="modify-deleted">
                            Reflection Deleted (All Old Access)
                            <span class="help-text">Paste all codes that were deleted</span>
                        </label>
                        <textarea 
                            id="modify-deleted" 
                            rows="8" 
                            placeholder="OLD1 OLD2 OLD3 ..."></textarea>
                        <small class="token-count" id="modify-deleted-count">0 codes</small>
                    </div>

                    <div class="input-group">
                        <label for="modify-readded">
                            Reflection Re-Added (All New Access)
                            <span class="help-text">Paste all codes that were re-added</span>
                        </label>
                        <textarea 
                            id="modify-readded" 
                            rows="8" 
                            placeholder="OLD1 OLD2 OLD3 DX2 DX7 DX5 ..."></textarea>
                        <small class="token-count" id="modify-readded-count">0 codes</small>
                    </div>
                </div>

                <!-- MONTHLY MODE INPUTS -->
                <div id="monthly-inputs" class="mode-inputs" style="display: none;">
                    <h2>Monthly Audit - Compare Excel to ServiceNow</h2>
                    <p class="info-text">‚ö†Ô∏è Compares Excel tracker codes to ServiceNow request codes</p>
                    
                    <div class="input-group">
                        <label for="monthly-excel">
                            Excel Column of Tracker File
                            <span class="help-text">Paste codes from Excel tracker (RRRR= will be stripped)</span>
                        </label>
                        <textarea 
                            id="monthly-excel" 
                            rows="12" 
                            placeholder="RRRR=DX2
RRRR=DX7
RRRR=DX5"></textarea>
                        <small class="token-count" id="monthly-excel-count">0 codes</small>
                    </div>

                    <div class="input-group">
                        <label for="monthly-servicenow">
                            ServiceNow Request (IA Codes Only)
                            <span class="help-text">Paste codes from ServiceNow request</span>
                        </label>
                        <textarea 
                            id="monthly-servicenow" 
                            rows="12" 
                            placeholder="DX2
DX7
DX5"></textarea>
                        <small class="token-count" id="monthly-servicenow-count">0 codes</small>
                    </div>
                </div>

            </section>

            <!-- Branch Code Duplicate Checker -->
            <section id="branch-checker-section" class="input-panel">
                <details class="collapsible-section">
                    <summary>
                        <span>üîç Branch Code Duplicate Checker (Optional)</span>
                        <span class="summary-icon">‚ñº</span>
                    </summary>
                    <div class="collapsible-content">
                        <p class="info-text">Check if codes already exist in branch bundles</p>
                        
                        <div class="branch-checker-inputs">
                            <div class="input-group">
                                <label for="branch-bundle-codes">
                                    Branch Bundle Contents
                                    <span class="help-text">Paste all codes from branch bundles</span>
                                </label>
                                <textarea 
                                    id="branch-bundle-codes" 
                                    rows="8" 
                                    placeholder="DX2 DX7 ABC DEF ..."></textarea>
                                <small class="token-count" id="branch-bundle-count">0 codes</small>
                            </div>

                            <div class="input-group">
                                <label for="codes-to-check">
                                    Codes to Check
                                    <span class="help-text">Paste codes to check for duplicates</span>
                                </label>
                                <textarea 
                                    id="codes-to-check" 
                                    rows="6" 
                                    placeholder="DX2 DX7 DX5 ..."></textarea>
                                <small class="token-count" id="codes-check-count">0 codes</small>
                            </div>

                            <button id="btn-check-branch" class="btn btn-primary">Check Duplicates</button>
                        </div>

                        <div id="branch-checker-results" style="display: none; margin-top: 1.5rem;">
                            <h3>Results:</h3>
                            <div id="branch-duplicates-list"></div>
                            <div id="branch-unique-list"></div>
                        </div>
                    </div>
                </details>
            </section>

            <!-- Results Section -->
            <section id="results-section" class="results-panel" style="display: none;">
                
                <div class="results-header">
                    <h2>Comparison Results</h2>
                    <button id="btn-export" class="btn btn-secondary">Export CSV</button>
                </div>

                <!-- ADD MODE RESULTS -->
                <div id="add-results" class="results-content">
                    
                    <div class="summary-stats">
                        <div class="stat-card stat-matched">
                            <div class="stat-number" id="stat-matched">0</div>
                            <div class="stat-label">Matched</div>
                        </div>
                        <div class="stat-card stat-missing">
                            <div class="stat-number" id="stat-missing">0</div>
                            <div class="stat-label">Missing</div>
                        </div>
                        <div class="stat-card stat-extra">
                            <div class="stat-number" id="stat-extra">0</div>
                            <div class="stat-label">Extra</div>
                        </div>
                        <div class="stat-card stat-errors">
                            <div class="stat-number" id="stat-errors">0</div>
                            <div class="stat-label">Errors</div>
                        </div>
                    </div>

                    <div class="excel-comparison">
                        <h3>üìä Side-by-Side Comparison</h3>
                        <div class="comparison-grid">
                            <div class="comparison-column">
                                <h4>Requested Codes</h4>
                                <div id="requested-codes-list" class="vertical-code-list"></div>
                            </div>
                            <div class="comparison-column">
                                <h4>Added Codes (All)</h4>
                                <div id="added-codes-list" class="vertical-code-list"></div>
                            </div>
                        </div>
                    </div>

                    <div class="result-section" id="requirements-section">
                        <h3 class="section-title info" id="requirements-title">üí° Requirements Validation</h3>
                        <div id="requirements-validation-details"></div>
                    </div>

                    <div class="result-section" id="errors-section">
                        <h3 class="section-title error">üî¥ Validation Errors</h3>
                        <div id="validation-errors" class="error-list"></div>
                    </div>

                    <div class="result-section" id="warnings-section">
                        <h3 class="section-title warning">‚ö†Ô∏è Warnings</h3>
                        <div id="warnings-list" class="warning-list"></div>
                    </div>

                </div>

                <!-- MODIFY MODE RESULTS -->
                <div id="modify-results" class="results-content" style="display: none;">
                    
                    <div class="summary-stats">
                        <div class="stat-card stat-matched">
                            <div class="stat-number" id="stat-matched-modify">0</div>
                            <div class="stat-label">Re-Added</div>
                        </div>
                        <div class="stat-card stat-missing">
                            <div class="stat-number" id="stat-missing-modify">0</div>
                            <div class="stat-label">Not Re-added</div>
                        </div>
                        <div class="stat-card stat-extra">
                            <div class="stat-number" id="stat-extra-modify">0</div>
                            <div class="stat-label">New Codes</div>
                        </div>
                        <div class="stat-card stat-errors">
                            <div class="stat-number" id="stat-errors-modify">0</div>
                            <div class="stat-label">Errors</div>
                        </div>
                    </div>

                    <div class="excel-comparison">
                        <h3>üìä Modify Comparison (4-Column View)</h3>
                        <div class="comparison-grid-four">
                            <div class="comparison-column">
                                <h4>Deleted</h4>
                                <div id="modify-deleted-list" class="vertical-code-list"></div>
                            </div>
                            <div class="comparison-column">
                                <h4>Re-Added</h4>
                                <div id="modify-readded-list" class="vertical-code-list"></div>
                            </div>
                            <div class="comparison-column">
                                <h4>Requested</h4>
                                <div id="modify-requested-list" class="vertical-code-list"></div>
                            </div>
                            <div class="comparison-column">
                                <h4>Final</h4>
                                <div id="modify-final-list" class="vertical-code-list"></div>
                            </div>
                        </div>
                    </div>

                    <div class="result-section" id="requirements-section-modify">
                        <h3 class="section-title info">üí° Requirements Validation</h3>
                        <div id="requirements-validation-details-modify"></div>
                    </div>

                    <div class="result-section" id="errors-section-modify">
                        <h3 class="section-title error">üî¥ Validation Errors</h3>
                        <div id="validation-errors-modify" class="error-list"></div>
                    </div>

                    <div class="result-section" id="warnings-section-modify">
                        <h3 class="section-title warning">‚ö†Ô∏è Warnings</h3>
                        <div id="warnings-list-modify" class="warning-list"></div>
                    </div>

                </div>

                <!-- MONTHLY RESULTS -->
                <div id="monthly-results" class="results-content" style="display: none;">
                    
                    <div class="comparison-container">
                        <div class="comparison-column">
                            <h3>Excel Tracker Codes</h3>
                            <div id="excel-codes-list" class="vertical-code-list"></div>
                        </div>

                        <div class="comparison-column">
                            <h3>ServiceNow Request Codes</h3>
                            <div id="servicenow-codes-list" class="vertical-code-list"></div>
                        </div>
                    </div>

                    <div class="monthly-summary">
                        <h4>Summary</h4>
                        <div id="monthly-summary-text"></div>
                    </div>

                </div>

            </section>

        </main>

        <!-- Modals -->
        
        <div id="log-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>üìã Activity Log</h2>
                    <button class="modal-close" data-modal="log-modal">&times;</button>
                </div>
                <div class="modal-body" id="log-content">
                    <p class="empty-state">No activity yet</p>
                </div>
            </div>
        </div>

        <div id="matrix-modal" class="modal">
            <div class="modal-content modal-wide">
                <div class="modal-header">
                    <h2>üìä Role & Matrix Guide</h2>
                    <button class="modal-close" data-modal="matrix-modal">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="matrix-selector">
                        <label for="matrix-role-select">Select Role:</label>
                        <select id="matrix-role-select">
                            <option value="">-- Select a Role --</option>
                            <option value="SA PROFILE">SA PROFILE</option>
                            <option value="SA WITH TRANSIT & SYND. PROFILE">SA WITH TRANSIT & SYND. PROFILE</option>
                            <option value="SA WITH SYNDICATE PROFILE">SA WITH SYNDICATE PROFILE</option>
                            <option value="IA PROFILE">IA PROFILE</option>
                            <option value="ASSOCIATE IA PROFILE">ASSOCIATE IA PROFILE</option>
                            <option value="Branch Assistant & Cage Profile">Branch Assistant & Cage Profile</option>
                            <option value="BA & CAGE INQUIRY">BA & CAGE INQUIRY</option>
                            <option value="BA/ABM/BM and Backup">BA/ABM/BM and Backup</option>
                            <option value="BA ABM BM AND BACKUP PROFILE">BA ABM BM AND BACKUP PROFILE</option>
                            <option value="BA/ABM/BM ACWS INQUIRY">BA/ABM/BM ACWS INQUIRY</option>
                            <option value="INQUIRY ONLY - BRANCH ASSISTANT AND CAGE PROFILE - Secondary Role">INQUIRY ONLY - Secondary Role</option>
                        </select>
                    </div>
                    
                    <div id="matrix-details" class="matrix-details">
                        <p class="empty-state">Select a role to view requirements</p>
                    </div>
                </div>
            </div>
        </div>

        <div id="options-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>‚öôÔ∏è Options</h2>
                    <button class="modal-close" data-modal="options-modal">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="option-group">
                        <label>
                            <input type="checkbox" id="opt-auto-scroll" checked>
                            Auto-scroll to results
                        </label>
                    </div>
                    <div class="option-group">
                        <label>
                            <input type="checkbox" id="opt-show-stats" checked>
                            Show summary statistics
                        </label>
                    </div>
                    <div class="option-group">
                        <label>
                            <input type="checkbox" id="opt-log-activity" checked>
                            Log all comparisons
                        </label>
                    </div>
                </div>
            </div>
        </div>

        <div id="guide-modal" class="modal">
            <div class="modal-content modal-wide">
                <div class="modal-header">
                    <h2>üìñ User Guide</h2>
                    <button class="modal-close" data-modal="guide-modal">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="guide-section">
                        <h3>System Types</h3>
                        <ul>
                            <li><strong>TOPS:</strong> Full matrix validation with all requirements</li>
                            <li><strong>Postedge:</strong> Uses RRRR for FUNC, no SCON (Add only)</li>
                            <li><strong>Fee Aggregator:</strong> MRGN + IA codes + *FEAGFUNC (Knowledge Base)</li>
                            <li><strong>VPS:</strong> IA codes + *VPSWGFUNC + branch MRGN (Knowledge Base)</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <div id="toast-container"></div>

        <footer id="main-footer">
            <p>Made by <span class="highlight">AQCM</span> ‚Äì David Duke Essel</p>
        </footer>

    </div>

    <script src="script.js"></script>
</body>
</html>